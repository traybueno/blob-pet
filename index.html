<!DOCTYPE html>
<html>
<head>
  <title>Blob Pet - Watchtower Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
      background: #1a1a2e;
      color: #eee;
      font-family: 'Press Start 2P', monospace;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .game-container {
      display: flex;
      gap: 16px;
      max-width: 700px;
    }
    
    /* Left sidebar */
    .sidebar {
      display: flex;
      flex-direction: column;
      gap: 8px;
      width: 120px;
    }
    
    .action-btn {
      background: #16213e;
      border: 3px solid #0f3460;
      padding: 12px 8px;
      color: #eee;
      font-family: 'Press Start 2P', monospace;
      font-size: 8px;
      cursor: pointer;
      text-align: center;
      transition: all 0.1s;
      image-rendering: pixelated;
    }
    .action-btn:hover:not(:disabled) {
      background: #0f3460;
      border-color: #10b981;
    }
    .action-btn:active:not(:disabled) {
      transform: scale(0.95);
    }
    .action-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    .action-btn .icon {
      font-size: 20px;
      display: block;
      margin-bottom: 6px;
    }
    .action-btn .cost {
      font-size: 6px;
      color: #fbbf24;
      margin-top: 4px;
    }
    
    .color-section {
      background: #16213e;
      border: 3px solid #0f3460;
      padding: 8px;
    }
    .color-section label {
      font-size: 6px;
      display: block;
      margin-bottom: 6px;
      color: #888;
    }
    .color-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 4px;
    }
    .color-opt {
      width: 20px;
      height: 20px;
      border: 2px solid #0f3460;
      cursor: pointer;
      image-rendering: pixelated;
    }
    .color-opt:hover { border-color: #fff; }
    .color-opt.selected { border-color: #10b981; }
    
    /* Main game screen */
    .game-screen {
      background: #16213e;
      border: 4px solid #0f3460;
      padding: 12px;
    }
    
    .screen-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 2px solid #0f3460;
    }
    .pet-name-display {
      font-size: 10px;
      color: #10b981;
    }
    .level-display {
      font-size: 8px;
      color: #888;
    }
    
    /* The gameboy-style viewport */
    .viewport {
      width: 320px;
      height: 240px;
      background: #c4cfa1;
      border: 4px solid #8b956d;
      position: relative;
      overflow: hidden;
      image-rendering: pixelated;
      cursor: pointer;
    }
    
    /* Pixel blob */
    .blob {
      position: absolute;
      width: 64px;
      height: 64px;
      transition: left 0.5s ease-in-out, top 0.5s ease-in-out;
    }
    
    .blob-body {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 32px;
      border-radius: 50% 50% 45% 45%;
      animation: blobIdle 1s ease-in-out infinite;
    }
    
    .blob-eye {
      position: absolute;
      width: 8px;
      height: 10px;
      background: #1a1a2e;
      border-radius: 50%;
      top: 8px;
    }
    .blob-eye.left { left: 8px; }
    .blob-eye.right { right: 8px; }
    
    .blob-eye-shine {
      position: absolute;
      width: 3px;
      height: 3px;
      background: #fff;
      border-radius: 50%;
      top: 2px;
      left: 1px;
    }
    
    .blob-mouth {
      position: absolute;
      bottom: 8px;
      left: 50%;
      transform: translateX(-50%);
      width: 6px;
      height: 3px;
      background: #1a1a2e;
      border-radius: 0 0 6px 6px;
    }
    
    /* Evolution parts - hidden by default */
    .blob-bump, .blob-leg, .blob-arm, .blob-antenna, .blob-crown { 
      display: none; 
      position: absolute;
    }
    
    /* Stage 2: Bump on head */
    .blob.stage-2 .blob-bump,
    .blob.stage-3 .blob-bump,
    .blob.stage-4 .blob-bump,
    .blob.stage-5 .blob-bump,
    .blob.stage-6 .blob-bump {
      display: block;
      width: 16px;
      height: 12px;
      border-radius: 50%;
      top: -6px;
      left: 50%;
      transform: translateX(-50%);
      background: inherit;
    }
    
    /* Stage 3: Legs */
    .blob.stage-3 .blob-leg,
    .blob.stage-4 .blob-leg,
    .blob.stage-5 .blob-leg,
    .blob.stage-6 .blob-leg {
      display: block;
      width: 8px;
      height: 10px;
      background: inherit;
      border-radius: 0 0 4px 4px;
      bottom: -8px;
    }
    .blob-leg.left { left: 8px; }
    .blob-leg.right { right: 8px; }
    
    /* Stage 4: Arms */
    .blob.stage-4 .blob-arm,
    .blob.stage-5 .blob-arm,
    .blob.stage-6 .blob-arm {
      display: block;
      width: 10px;
      height: 8px;
      background: inherit;
      border-radius: 50%;
      top: 12px;
    }
    .blob-arm.left { left: -6px; }
    .blob-arm.right { right: -6px; }
    
    /* Stage 5: Antennae */
    .blob.stage-5 .blob-antenna,
    .blob.stage-6 .blob-antenna {
      display: block;
      width: 4px;
      height: 12px;
      background: inherit;
      border-radius: 4px;
      top: -14px;
    }
    .blob-antenna.left { left: 10px; transform: rotate(-15deg); }
    .blob-antenna.right { right: 10px; transform: rotate(15deg); }
    .blob-antenna::after {
      content: '';
      position: absolute;
      top: -4px;
      left: -2px;
      width: 8px;
      height: 8px;
      background: inherit;
      border-radius: 50%;
    }
    
    /* Stage 6: Crown/Halo */
    .blob.stage-6 .blob-crown {
      display: block;
      width: 24px;
      height: 10px;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      background: #fbbf24;
      clip-path: polygon(0% 100%, 15% 40%, 30% 100%, 50% 20%, 70% 100%, 85% 40%, 100% 100%);
      animation: crownFloat 2s ease-in-out infinite;
    }
    
    @keyframes crownFloat {
      0%, 100% { transform: translateX(-50%) translateY(0); }
      50% { transform: translateX(-50%) translateY(-3px); }
    }
    
    /* Blob states */
    .blob.eating .blob-body {
      animation: munch 0.2s ease-in-out infinite;
    }
    .blob.eating .blob-mouth {
      width: 12px;
      height: 10px;
      border-radius: 50%;
    }
    
    .blob.playing {
      animation: playBounce 0.3s ease-in-out infinite;
    }
    .blob.playing .blob-body {
      animation: playSquash 0.3s ease-in-out infinite;
    }
    
    .blob.happy .blob-mouth {
      width: 12px;
      height: 6px;
      border-radius: 0 0 12px 12px;
    }
    
    /* Size scaling per stage */
    .blob.stage-1 { transform: scale(0.8); }
    .blob.stage-2 { transform: scale(0.9); }
    .blob.stage-3 { transform: scale(1); }
    .blob.stage-4 { transform: scale(1.1); }
    .blob.stage-5 { transform: scale(1.2); }
    .blob.stage-6 { transform: scale(1.3); }
    
    @keyframes blobIdle {
      0%, 100% { transform: translateX(-50%) scaleY(1) scaleX(1); }
      50% { transform: translateX(-50%) scaleY(0.92) scaleX(1.04); }
    }
    
    @keyframes munch {
      0%, 100% { transform: translateX(-50%) scaleY(1) scaleX(1); }
      50% { transform: translateX(-50%) scaleY(0.85) scaleX(1.1); }
    }
    
    @keyframes playBounce {
      0%, 100% { transform: translateY(0) scale(var(--stage-scale, 1)); }
      50% { transform: translateY(-25px) scale(var(--stage-scale, 1)); }
    }
    
    @keyframes playSquash {
      0%, 100% { transform: translateX(-50%) scaleY(1) scaleX(1); }
      25% { transform: translateX(-50%) scaleY(1.2) scaleX(0.85); }
      75% { transform: translateX(-50%) scaleY(0.8) scaleX(1.15); }
    }
    
    /* Feed animation - hearts float up */
    .feed-heart {
      position: absolute;
      font-size: 16px;
      pointer-events: none;
      animation: heartFloat 1s ease-out forwards;
    }
    @keyframes heartFloat {
      0% { opacity: 1; transform: translateY(0) scale(0.5); }
      50% { opacity: 1; transform: translateY(-20px) scale(1.2); }
      100% { opacity: 0; transform: translateY(-40px) scale(0.8); }
    }
    
    /* Play animation - stars burst */
    .play-star {
      position: absolute;
      font-size: 14px;
      pointer-events: none;
      animation: starBurst 0.8s ease-out forwards;
    }
    @keyframes starBurst {
      0% { opacity: 1; transform: translate(0, 0) scale(0.5) rotate(0deg); }
      100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(1) rotate(180deg); }
    }
    
    /* Click feedback */
    .coin-popup {
      position: absolute;
      font-size: 10px;
      color: #1a1a2e;
      font-family: 'Press Start 2P', monospace;
      pointer-events: none;
      animation: coinFloat 0.8s ease-out forwards;
    }
    
    @keyframes coinFloat {
      0% { opacity: 1; transform: translateY(0); }
      100% { opacity: 0; transform: translateY(-30px); }
    }
    
    /* Stats bar below viewport */
    .stats-bar {
      margin-top: 8px;
      padding-top: 8px;
      border-top: 2px solid #0f3460;
    }
    
    .stat-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }
    .stat-label {
      font-size: 6px;
      width: 50px;
      color: #888;
    }
    .stat-track {
      flex: 1;
      height: 12px;
      background: #0f3460;
      border: 2px solid #0a0a1a;
    }
    .stat-fill {
      height: 100%;
      transition: width 0.3s;
    }
    .stat-fill.coins { background: #fbbf24; }
    .stat-fill.xp { background: #10b981; }
    .stat-value {
      font-size: 8px;
      width: 60px;
      text-align: right;
    }
    
    .level-up-hint {
      font-size: 6px;
      color: #10b981;
      text-align: center;
      margin-top: 4px;
    }
    
    /* Footer */
    .footer {
      margin-top: 8px;
      font-size: 6px;
      color: #444;
      text-align: center;
    }
    .footer a { color: #10b981; text-decoration: none; }
    
    .save-indicator {
      font-size: 6px;
      color: #444;
      text-align: center;
      margin-top: 4px;
    }
    .save-indicator.saving { color: #fbbf24; }
    .save-indicator.saved { color: #10b981; }
    
    /* Onboarding modal */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal.show { display: flex; }
    
    .modal-content {
      background: #16213e;
      border: 4px solid #10b981;
      padding: 24px;
      text-align: center;
      max-width: 300px;
    }
    .modal-content h2 {
      font-size: 12px;
      margin-bottom: 16px;
      color: #10b981;
    }
    .modal-content p {
      font-size: 8px;
      margin-bottom: 16px;
      line-height: 1.6;
    }
    .modal-content input {
      width: 100%;
      padding: 12px;
      font-family: 'Press Start 2P', monospace;
      font-size: 10px;
      background: #0f3460;
      border: 3px solid #10b981;
      color: #fff;
      text-align: center;
      margin-bottom: 16px;
    }
    .modal-content input::placeholder {
      color: #666;
    }
    .modal-content button {
      background: #10b981;
      border: none;
      padding: 12px 24px;
      font-family: 'Press Start 2P', monospace;
      font-size: 10px;
      color: #000;
      cursor: pointer;
    }
    .modal-content button:hover {
      background: #34d399;
    }
    
    /* Level up modal */
    .level-up-modal .modal-content {
      border-color: #fbbf24;
    }
    .level-up-modal h2 {
      color: #fbbf24 !important;
    }
    .level-up-modal .new-level {
      font-size: 32px;
      margin: 16px 0;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <!-- Left sidebar -->
    <div class="sidebar">
      <button class="action-btn" id="feed-btn" onclick="feed()">
        <span class="icon">üçé</span>
        Feed
        <span class="cost" id="feed-cost">5 coins</span>
      </button>
      
      <button class="action-btn" id="play-btn" onclick="play()">
        <span class="icon">üéæ</span>
        Play
        <span class="cost" id="play-cost">10 coins</span>
      </button>
      
      <div class="color-section">
        <label>COLOR</label>
        <div class="color-grid" id="color-grid"></div>
      </div>
    </div>
    
    <!-- Main screen -->
    <div class="game-screen">
      <div class="screen-header">
        <div class="pet-name-display" id="pet-name">BLOBBY</div>
        <div class="level-display">LV.<span id="level-num">1</span></div>
      </div>
      
      <div class="viewport" id="viewport" onclick="clickBlob(event)">
        <div class="blob stage-1" id="blob">
          <!-- Crown (stage 6) -->
          <div class="blob-crown"></div>
          <!-- Antennae (stage 5+) -->
          <div class="blob-antenna left"></div>
          <div class="blob-antenna right"></div>
          <!-- Main body -->
          <div class="blob-body" id="blob-body">
            <!-- Bump (stage 2+) -->
            <div class="blob-bump"></div>
            <!-- Arms (stage 4+) -->
            <div class="blob-arm left"></div>
            <div class="blob-arm right"></div>
            <!-- Face -->
            <div class="blob-eye left"><div class="blob-eye-shine"></div></div>
            <div class="blob-eye right"><div class="blob-eye-shine"></div></div>
            <div class="blob-mouth"></div>
            <!-- Legs (stage 3+) -->
            <div class="blob-leg left"></div>
            <div class="blob-leg right"></div>
          </div>
        </div>
      </div>
      
      <div class="stats-bar">
        <div class="stat-row">
          <span class="stat-label">COINS</span>
          <div class="stat-track">
            <div class="stat-fill coins" id="coins-bar" style="width: 0%"></div>
          </div>
          <span class="stat-value" id="coins-value">0</span>
        </div>
        <div class="stat-row">
          <span class="stat-label">XP</span>
          <div class="stat-track">
            <div class="stat-fill xp" id="xp-bar" style="width: 0%"></div>
          </div>
          <span class="stat-value" id="xp-value">0/100</span>
        </div>
        <div class="level-up-hint" id="level-hint"></div>
      </div>
      
      <div class="save-indicator" id="save-status">CONNECTING...</div>
      <div class="footer">
        CLOUD SAVES BY <a href="https://watchtower.host" target="_blank">WATCHTOWER</a>
      </div>
    </div>
  </div>
  
  <!-- Name modal -->
  <div class="modal" id="name-modal">
    <div class="modal-content">
      <h2>NEW BLOB!</h2>
      <p>A WILD BLOB APPEARED! GIVE IT A NAME:</p>
      <input type="text" id="name-input" placeholder="BLOBBY" maxlength="10" autocomplete="off">
      <button onclick="submitName()">START</button>
    </div>
  </div>
  
  <!-- Level up modal -->
  <div class="modal level-up-modal" id="levelup-modal">
    <div class="modal-content">
      <h2>LEVEL UP!</h2>
      <div class="new-level" id="new-level">üéâ</div>
      <p id="levelup-text">YOUR BLOB GREW!</p>
      <button onclick="closeLevelUp()">NICE!</button>
    </div>
  </div>

  <script type="module">
    import { connect } from 'https://esm.sh/@watchtower-sdk/core@0.5.0'
    
    const COLORS = ['#10b981', '#3b82f6', '#8b5cf6', '#ec4899', '#f97316', '#eab308', '#ef4444', '#06b6d4']
    const STAGES = [1, 5, 10, 20, 35, 50] // Level thresholds for each stage
    const STAGE_NAMES = ['BABY', 'SMALL', 'MEDIUM', 'BIG', 'HUGE', 'MEGA']
    
    let state = {
      name: '',
      coins: 0,
      xp: 0,
      level: 1,
      color: COLORS[0],
      totalClicks: 0
    }
    
    let room = null
    let blobX = 140, blobY = 100
    let targetX = 140, targetY = 100
    
    const playerId = localStorage.getItem('blobPetId') || crypto.randomUUID()
    localStorage.setItem('blobPetId', playerId)
    
    // DOM
    const blob = document.getElementById('blob')
    const blobBody = document.getElementById('blob-body')
    const viewport = document.getElementById('viewport')
    
    // Initialize
    async function init() {
      setupColors()
      
      try {
        room = await connect('blob-pet-saves', { 
          gameId: 'blob-pet',
          playerId: playerId
        })
        
        const saved = await room.load('pet')
        if (saved) {
          state = { ...state, ...saved }
          updateUI()
          showSave('saved', 'LOADED!')
        } else {
          // First time - show name modal
          document.getElementById('name-modal').classList.add('show')
        }
        
        // Auto-save
        setInterval(saveGame, 30000)
        
      } catch (e) {
        console.error('Connection failed:', e)
        showSave('error', 'OFFLINE')
        // Still allow play offline
        if (!state.name) {
          document.getElementById('name-modal').classList.add('show')
        }
      }
      
      updateUI()
      
      // Blob wanders around
      setInterval(wanderBlob, 2000)
      moveBlob()
    }
    
    function setupColors() {
      const grid = document.getElementById('color-grid')
      grid.innerHTML = COLORS.map(c => 
        `<div class="color-opt ${c === state.color ? 'selected' : ''}" 
              style="background:${c}" 
              data-color="${c}"
              onclick="selectColor('${c}')"></div>`
      ).join('')
    }
    
    window.selectColor = (color) => {
      state.color = color
      document.querySelectorAll('.color-opt').forEach(el => {
        el.classList.toggle('selected', el.dataset.color === color)
      })
      applyBlobColor(color)
      saveGame()
    }
    
    function applyBlobColor(color) {
      // Apply color to all blob parts
      blobBody.style.background = color
      document.querySelectorAll('.blob-bump, .blob-leg, .blob-arm, .blob-antenna').forEach(el => {
        el.style.background = color
      })
    }
    
    window.submitName = () => {
      const input = document.getElementById('name-input')
      state.name = (input.value.trim() || 'BLOBBY').toUpperCase()
      document.getElementById('name-modal').classList.remove('show')
      updateUI()
      saveGame()
    }
    
    function wanderBlob() {
      targetX = 20 + Math.random() * 240
      targetY = 20 + Math.random() * 160
    }
    
    function moveBlob() {
      // Smooth movement toward target
      blobX += (targetX - blobX) * 0.05
      blobY += (targetY - blobY) * 0.05
      
      blob.style.left = blobX + 'px'
      blob.style.top = blobY + 'px'
      
      requestAnimationFrame(moveBlob)
    }
    
    window.clickBlob = (e) => {
      const rect = viewport.getBoundingClientRect()
      const x = e.clientX - rect.left
      const y = e.clientY - rect.top
      
      // More coins at higher levels
      const earned = 1 + Math.floor(state.level / 3)
      state.coins += earned
      state.totalClicks++
      
      // Show coin popup
      const popup = document.createElement('div')
      popup.className = 'coin-popup'
      popup.textContent = '+' + earned
      popup.style.left = x + 'px'
      popup.style.top = y + 'px'
      viewport.appendChild(popup)
      setTimeout(() => popup.remove(), 800)
      
      // Happy reaction
      blob.classList.add('happy')
      setTimeout(() => blob.classList.remove('happy'), 300)
      
      updateUI()
    }
    
    window.feed = () => {
      const cost = getFeedCost()
      if (state.coins < cost) return
      
      state.coins -= cost
      addXP(15)
      
      // Eating animation
      blob.classList.add('eating')
      setTimeout(() => blob.classList.remove('eating'), 1500)
      
      // Heart particles
      for (let i = 0; i < 5; i++) {
        setTimeout(() => {
          const heart = document.createElement('div')
          heart.className = 'feed-heart'
          heart.textContent = '‚ù§Ô∏è'
          heart.style.left = (blobX + 20 + Math.random() * 24) + 'px'
          heart.style.top = (blobY + 10) + 'px'
          viewport.appendChild(heart)
          setTimeout(() => heart.remove(), 1000)
        }, i * 150)
      }
      
      updateUI()
      saveGame()
    }
    
    window.play = () => {
      const cost = getPlayCost()
      if (state.coins < cost) return
      
      state.coins -= cost
      addXP(25)
      
      // Play animation
      blob.classList.add('playing')
      setTimeout(() => blob.classList.remove('playing'), 2000)
      
      // Star burst particles
      const stars = ['‚≠ê', '‚ú®', 'üí´', 'üåü']
      for (let i = 0; i < 8; i++) {
        const star = document.createElement('div')
        star.className = 'play-star'
        star.textContent = stars[Math.floor(Math.random() * stars.length)]
        star.style.left = (blobX + 32) + 'px'
        star.style.top = (blobY + 20) + 'px'
        const angle = (i / 8) * Math.PI * 2
        star.style.setProperty('--tx', Math.cos(angle) * 50 + 'px')
        star.style.setProperty('--ty', Math.sin(angle) * 50 + 'px')
        viewport.appendChild(star)
        setTimeout(() => star.remove(), 800)
      }
      
      updateUI()
      saveGame()
    }
    
    function getFeedCost() {
      return 5 + state.level * 2
    }
    
    function getPlayCost() {
      return 10 + state.level * 3
    }
    
    function getXPNeeded() {
      return Math.floor(100 * Math.pow(1.3, state.level - 1))
    }
    
    function getStage() {
      for (let i = STAGES.length - 1; i >= 0; i--) {
        if (state.level >= STAGES[i]) return i + 1
      }
      return 1
    }
    
    function addXP(amount) {
      state.xp += amount
      
      const needed = getXPNeeded()
      if (state.xp >= needed) {
        state.xp -= needed
        state.level++
        showLevelUp()
      }
      
      updateUI()
    }
    
    function showLevelUp() {
      const stage = getStage()
      document.getElementById('new-level').textContent = `LV.${state.level}`
      document.getElementById('levelup-text').textContent = 
        state.level === STAGES[stage - 1] 
          ? `EVOLVED TO ${STAGE_NAMES[stage - 1]} BLOB!` 
          : 'YOUR BLOB GREW STRONGER!'
      document.getElementById('levelup-modal').classList.add('show')
      saveGame()
    }
    
    window.closeLevelUp = () => {
      document.getElementById('levelup-modal').classList.remove('show')
    }
    
    function updateUI() {
      // Name & level
      document.getElementById('pet-name').textContent = state.name || 'BLOBBY'
      document.getElementById('level-num').textContent = state.level
      
      // Blob appearance
      const stage = getStage()
      blob.className = `blob stage-${stage}`
      applyBlobColor(state.color)
      
      // Coins bar (max out at 999 for display)
      const coinsPercent = Math.min(100, (state.coins / (100 + state.level * 50)) * 100)
      document.getElementById('coins-bar').style.width = coinsPercent + '%'
      document.getElementById('coins-value').textContent = state.coins
      
      // XP bar
      const xpNeeded = getXPNeeded()
      const xpPercent = (state.xp / xpNeeded) * 100
      document.getElementById('xp-bar').style.width = xpPercent + '%'
      document.getElementById('xp-value').textContent = `${state.xp}/${xpNeeded}`
      
      // Costs
      document.getElementById('feed-cost').textContent = getFeedCost() + ' coins'
      document.getElementById('play-cost').textContent = getPlayCost() + ' coins'
      
      // Button states
      document.getElementById('feed-btn').disabled = state.coins < getFeedCost()
      document.getElementById('play-btn').disabled = state.coins < getPlayCost()
      
      // Level hint
      const nextStage = STAGES.find(s => s > state.level)
      if (nextStage) {
        document.getElementById('level-hint').textContent = 
          `EVOLVE AT LV.${nextStage}`
      } else {
        document.getElementById('level-hint').textContent = 'MAX EVOLUTION!'
      }
    }
    
    async function saveGame() {
      if (!room) return
      showSave('saving', 'SAVING...')
      try {
        await room.save('pet', state)
        showSave('saved', 'SAVED!')
      } catch (e) {
        showSave('error', 'SAVE FAILED')
      }
    }
    
    function showSave(type, text) {
      const el = document.getElementById('save-status')
      el.className = 'save-indicator ' + type
      el.textContent = text
      if (type === 'saved') {
        setTimeout(() => {
          el.textContent = 'AUTO-SAVE ON'
          el.className = 'save-indicator'
        }, 2000)
      }
    }
    
    // Start
    init()
  </script>
</body>
</html>
